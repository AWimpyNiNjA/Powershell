# This script checks for attempted violations of CVE-2020-0601 on PATCHED endpoints.

Get-WinEvent -FilterHashtable @{ LogName = 'Application'; Id = 1; ProviderName = 'Microsoft-Windows-Audit-CVE' } | Select -Property * -ExcludeProperty MachineName, UserId

# Credit goes to @mattifestation on Twitter for this script.
#
# To provide realtime monitoring for CVE-2020-0601 attempted violations create a rule in your RMM, SIEM, Log Aggregator etc... 
# to watch for event ID 1 in the Application log, with source name Microsoft-Windows-Audit-CVE, and send out an alert when it is detected.
# Once your rule is created, run this command to verify that it is working as intended
#

# Write-EventLog -LogName "Application" -Source "Microsoft-Windows-Audit-CVE" -EventId 1 -EntryType Warning -Message "Test of CVE-2020-0601 Violation"

#
# After running the above script, an Event in the Application log, with event ID 1 and source Microsoft-Windows-Audit-CVE will be generated.
# If your rule is working properly, this should create an alert in your system.
